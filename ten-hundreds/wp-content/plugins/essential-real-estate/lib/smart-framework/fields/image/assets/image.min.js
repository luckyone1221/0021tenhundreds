var GSF_ImageClass=function(i){this.$container=i};(function(s){"use strict";GSF_ImageClass.prototype={init:function(){this.selectMedia()},selectMedia:function(){var n=this,a=n.$container.find(".gsf-image-id"),t=n.$container.find(".gsf-image-url"),i=n.$container.find(".gsf-image-choose-image"),e=n.$container.find(".gsf-image-remove"),r=n.$container.find(".gsf-image-preview img");var c=new GSF_Media;c.selectImage(i,{filter:"image"},function(i){if(i){var e="";if(i.sizes.thumbnail==undefined){e=i.sizes.full.url}else{e=i.sizes.thumbnail.url}r.attr("src",e);r.show();a.val(i.id);t.val(i.url);n.changeField()}});e.on("click",function(){r.attr("src","");r.hide();a.val("");t.val("");n.changeField()});t.on("change",function(){s.ajax({url:GSF_META_DATA.ajaxUrl+"?action=gsf_get_attachment_id",data:{url:t.val()},type:"GET",error:function(){a.val("0");n.changeField()},success:function(i){a.val(i);n.changeField()}});if(t.val()==""){r.attr("src","");r.hide()}else{r.attr("src",t.val());r.show()}})},changeField:function(){this.$container.find(".gsf-image-id").trigger("gsf_field_control_changed");this.$container.find(".gsf-image-id").trigger("change")},getValue:function(){var a={};this.$container.find("[data-field-control]").each(function(){var i=s(this),e=i.attr("name"),n=e.replace(/^(.*)(\[)([^\]]*)(\])*$/g,function(i,e,n,a,t){return a});a[n]=i.val()});return a}}})(jQuery);