var GSF_EditorClass=function(t){this.$container=t};(function(n){"use strict";GSF_EditorClass.prototype={init:function(){this.initNotExistEditor()},initNotExistEditor:function(){if(this.$container.find(".mce-tinymce").length==0){var t=this.$container.find(".wp-editor-area"),i=t.attr("id");if(typeof tinyMCEPreInit=="undefined"){return}if(!t.closest(".gsf-field-clone-item").length){return}if(i in tinyMCEPreInit.mceInit){try{var n=JSON.parse(JSON.stringify(tinyMCEPreInit.mceInit[i]));tinymce.execCommand("mceRemoveEditor",false,i);tinymce.init(n)}catch(t){}}if(i in tinyMCEPreInit.qtInit){var e=JSON.parse(JSON.stringify(tinyMCEPreInit.qtInit[i]));quicktags({id:i,buttons:e["buttons"]});QTags._buttonsInit()}}},getValue:function(){return this.$container.find("[data-field-control]").val()}};var e={cloneItem:function(t){var i=t.find(".wp-editor-area"),n=i.attr("name"),e=n.replace(/[\[\]]/g,"__")+"__editor",r=i.attr("id");t.find(".wp-editor-wrap").attr("id","wp-"+e+"-wrap").removeClass("html-active").addClass("tmce-active").find(".wp-editor-tools").attr("id","wp-"+e+"-editor-tools").find(".wp-media-buttons").attr("id","wp-"+e+"-media-buttons").find(".insert-media").data("editor",e);t.find(".switch-tmce").attr("id",e+"-tmce").data("wp-editor-id",e).attr("data-wp-editor-id",e).end().find(".switch-html").attr("id",e+"-html").data("wp-editor-id",e).attr("data-wp-editor-id",e);t.find(".wp-editor-container").attr("id","wp-"+e+"-editor-container").find(".quicktags-toolbar").attr("id","qt_"+e+"_toolbar").html("");t.find(".wp-editor-container").find(".wp-editor-area").attr("id",e).val("");if(r in tinyMCEPreInit.mceInit){var a=JSON.parse(JSON.stringify(tinyMCEPreInit.mceInit[r]));a["body_class"]=a["body_class"].replace(r,e);a["selector"]=a["selector"].replace(r,e);tinyMCEPreInit.mceInit[e]=a;tinymce.execCommand("mceRemoveEditor",false,e);tinymce.init(a)}if(r in tinyMCEPreInit.qtInit){var o=JSON.parse(JSON.stringify(tinyMCEPreInit.qtInit[r]));quicktags({id:e,buttons:o["buttons"]});QTags._buttonsInit()}},onChange:function(t){if(tinymce.editors[t].isChangeEvent==null){tinymce.editors[t].isChangeEvent=true;tinymce.editors[t].on("change",function(t){if(t.lastLevel!=null){this.save();n(this.container).closest(".gsf-field-content-inner").find(".wp-editor-area").trigger("gsf_field_control_changed")}})}},onChangeEditor:function(){setTimeout(function(){if(typeof tinymce!=="undefined"){for(var t=0;t<tinymce.editors.length;t++){e.onChange(t)}}},1e3)}};n(document).on("gsf_add_clone_field",function(t){var i=n(t.target);if(i.find(".gsf-field-editor-inner").length>0){e.cloneItem(n(t.target));e.onChangeEditor()}});n(document).ready(function(){e.onChangeEditor()})})(jQuery);