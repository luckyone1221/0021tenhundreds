String.prototype.capitalize=function(){return this.replace(/((^|\s)+)(.)/g,function(e,i,n,t){return i+t.toUpperCase()})};var GSF=GSF||{};(function(g){"use strict";var e=g(document);GSF.helper={isCheckBox:function(e){return e.is(":checkbox")},isRadio:function(e){return e.is(":radio")},isText:function(e){return(e.is("input")||e.is("textarea"))&&!this.isCheckBox(e)&&!this.isRadio(e)},isSelect:function(e){return e.is("select")},changeCloneNameIndex:function(e,i,n,t,m,S,C,l){var f=e.closest(".widget-content").length>0,r="";if(f){r=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a){return i+n+t+l});i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a){return r+a})}if(n&&t){if(m>=0){if(S>=0){if(l){i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a,o,d,c,u,g,h,p,v,F){return i+n+m+l+f+r+s+a+S+d+c+u+g+h+C+v+F})}else{i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a,o,d,c){return i+n+m+l+f+r+s+a+S+d+c})}}else if(l){i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a,o,d,c,u,g,h){return i+n+m+l+f+r+s+a+o+d+c+C+g+h})}else{i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f){return i+n+C+l+f})}}else if(S>=0){if(l){i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a,o,d,c,u,g,h){return i+n+t+l+f+S+s+a+o+d+c+C+g+h})}else{i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a){return i+n+t+l+f+C+s+a})}}else{i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a,o,d,c){return i+n+t+l+f+r+s+a+C+d+c})}}else if(n||t){if(m>=0){if(l){i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a,o,d,c){return i+n+m+l+f+r+s+a+C+d+c})}else{i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f){return i+n+C+l+f})}}else if(S>=0){if(l){i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a,o,d,c){return i+n+S+l+f+r+s+a+C+d+c})}else{i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f){return i+n+C+l+f})}}else{i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f,r,s,a){return i+n+t+l+f+C+s+a})}}else{i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(.*)/g,function(e,i,n,t,l,f){return i+n+C+l+f})}if(f){i=r+"["+i.replace(/^([^\[]+)(\[)(.*)/g,function(e,i,n,t,l,f){return i+"]"+n+t})}return i}};GSF.fields={createFieldObject:function(e,i){if(e==null||e==""){return null}var n="GSF_"+e.capitalize()+"Class";if(typeof window[n]==="undefined"){return null}return new window[n](i)},init:function(){this.timeOutFunc(this.addCloneButtonClick);this.timeOutFunc(this.removeCloneButtonClick);this.timeOutFunc(this.sectionClick);this.timeOutFunc(this.sectionTitleClick);g(document).trigger("gsf_before_init_fields");g(".gsf-meta-box-wrap").each(function(){var e=g(this);if(!e.closest("#widgets-left").length){GSF.fields.initFields(e)}});g(document).trigger("gsf_after_init_fields")},timeOutFunc:function(e){setTimeout(e,1)},initFields:function(e){GSF.fields.onChangeFieldControl(e);e.each(function(){GSF.required.processApplyField(this)});GSF.required.onChange(e);GSF.fields.makeCloneTemplate(e);GSF.fields.sortable(e);GSF.fields.changePanelTitleEvent(e);GSF.fields.stickySection(e);GSF.fields.initFieldsDetails(e);e.find(".gsf-section-container").first().show();if(e.find(".gsf-sections li.active").length==0){e.find(".gsf-sections li").first().addClass("active")}GSF.fields.initFieldJs(e.find(".gsf-section-container").first());e.find(".gsf-meta-box-wrap-loading").addClass("in")},initFieldsDetails:function(e){var f=e.find(".gsf-section-container").length==0||g(".gsf-term-meta-add-new").length!=0;e.find(".gsf-field-content-inner").each(function(){var e=g(this),i=e.closest(".gsf-field"),n=i.data("field-type"),t=GSF.fields.createFieldObject(n,e);if(t!=null){this.fieldJs=t;var l=this.fieldJs;if(f){setTimeout(function(){l.init();l.initDone=true},1)}}})},initFieldJs:function(e){e.find(".gsf-field-content-inner").each(function(){if(this.fieldJs!=null){if(this.fieldJs.initDone==null){var e=this;setTimeout(function(){e.fieldJs.init();e.fieldJs.initDone=true},1)}}})},stickySection:function(e){var i=32,n=g(".gsf-theme-options-action-inner");if(n.length){i+=n.outerHeight()}e.find(".gsf-sections > ul").hcSticky({top:i})},changePanelTitleEvent:function(e){e.find(".gsf-field-panel-inner").each(function(e){var i=g(this),n=i.data("panel-title");i.data("panel-title-text",i.find(".gsf-field-panel-title-text").html());if(n!=null&&n!==""){i.find("#"+n).find("[data-field-control]").on("change",function(){GSF.fields.changePanelTitle(this)})}if(e>0){i.find(".gsf-field-panel-content").hide();i.closest(".gsf-field-panel-clone-item").addClass("in")}});GSF.fields.initPanelTitle(e)},initPanelTitle:function(e){e.find(".gsf-field-panel-inner").each(function(){var e=g(this),i=e.data("panel-title");if(i!=null&&i!==""){e.find("#"+i).find("[data-field-control]").each(function(){GSF.fields.changePanelTitle(this)})}})},changePanelTitle:function(e){var i=g(e),n=i.closest(".gsf-field-panel-inner");if(i.val()==""){n.find(".gsf-field-panel-title-text").html(n.data("panel-title-text"))}else{n.find(".gsf-field-panel-title-text").html(i.val())}},makeCloneTemplate:function(e){e.find(".gsf-field-clone-wrapper").each(function(){var e=g(this),i=e.find("> .gsf-field-clone-item").last();if(i.length>0){e.data("clone-template",i[0].outerHTML)}})},sectionClick:function(){g(e).on("click",".gsf-sections a",function(e){var i=g(this),n=i.attr("href");if(n[0]!=="#"){return}e.preventDefault();var t=g(e.target).closest(".gsf-meta-box-wrap"),l=t.find(n);i.closest("ul").find("li").removeClass("active");i.parent().addClass("active");t.find(".gsf-section-container").hide();l.show();GSF.fields.initFieldJs(l);i.trigger("gsf_section_changed");t.find(n).find(".gsf-map-canvas").each(function(){if(typeof google!="undefined"&&typeof google.maps!="undefined"&&typeof google.maps.event!="undefined"&&typeof google.maps.event.trigger!="undefined"){google.maps.event.trigger(this,"resize")}})})},sectionTitleClick:function(){g(document).on("click",".gsf-section-title",function(){var e=g(this);e.toggleClass("in");e.next().slideToggle();var i=e.closest(".gsf-section-container");GSF.fields.initFieldJs(i)})},removeCloneButtonClick:function(){e.on("click",".gsf-clone-button-remove",function(){var e=g(this),i=e.closest(".gsf-field-clone-wrapper");e.closest(".gsf-field-clone-item").remove();GSF.fields.reIndexCloneField(i)})},addCloneButtonClick:function(){e.on("click",".gsf-clone-button-add",function(){var e=g(this),i=e.parent().find("> .gsf-field-clone-wrapper"),n=g(i.data("clone-template"));GSF.fields.changeNameBeforeClone(n);i.append(n);GSF.fields.reIndexCloneField(i);GSF.fields.restoreNameAfterClone(n);GSF.fields.initFields(n);GSF.fields.onChangeFieldControl(n);GSF.required.onChange(n);n.trigger("gsf_add_clone_field");n.find(".gsf-field").trigger("gsf_check_required")})},changeNameBeforeClone:function(e){e.find("[data-field-control]").each(function(){var e=g(this),i=e.attr("name");if(i!=null&&i.indexOf("____")!==0){e.attr("name","____"+i)}})},restoreNameAfterClone:function(e){e.find("[data-field-control]").each(function(){var e=g(this),i=e.attr("name");if(i!=null&&i.indexOf("____")===0){i=i.substring(4);e.attr("name",i)}})},onChangeFieldControl:function(e){e.find("[data-field-control]").on("change",function(){g(this).trigger("gsf_field_control_changed")}).on("gsf_field_control_changed",function(){var e=g(this);if(e.data("field-no-change")){e.data("field-no-change",false);return}if(e.data("field-set-value")){return}var i=e.closest(".gsf-field"),n=GSF.fields.getValue(i);i.data("field-value",n);i.trigger("gsf_check_required");i.trigger("gsf_check_preset");i.trigger("gsf_field_change")})},reIndexCloneField:function(e){e.find("> .gsf-field-clone-item").each(function(o){var e=g(this);e.data("clone-index",o);e.find("[data-field-control]").each(function(){var e=g(this),i=e.attr("name");if(i==null&&i===""){return}var n=e.closest(".gsf-field").find(".gsf-field-clone-item").length;var t=e.closest(".gsf-field-repeater-clone-item"),l=t.data("clone-index");if(l==null||l===""){l=-1}var f=e.closest(".gsf-field-panel-clone-item"),r=f.data("clone-index");if(r==null||r===""){r=-1}var s=e.closest(".gsf-field-panel").length>0,a=e.closest(".gsf-field-repeater").length>0;i=GSF.helper.changeCloneNameIndex(e,i,s,a,r,l,o,n);e.attr("name",i)})})},sortable:function(e){e.find(".gsf-field-clone-wrapper").sortable({items:".gsf-field-clone-item",placeholder:"gsf-field-clone-sortable-placeholder",handle:".gsf-sortable-button,.gsf-field-panel-title.gsf-field-panel-title-sortable",cancel:".gsf-clone-button-remove,.gsf-field-panel-title-toggle",update:function(e,i){var n=g(e.target);GSF.fields.reIndexCloneField(n)},stop:function(e,i){var n=i.item.find("textarea.wp-editor-area");n.each(function(e,i){var n,t;n=tinyMCE.EditorManager.get(i.id);t=g(this).parents(".tmce-active").length;if(n&&t){g(this).parent().find(" > .mce-container").remove();g("#"+i.id).val(n.getContent());g("#"+i.id).show();var l=tinyMCEPreInit.mceInit[i.id];tinymce.init(l)}})}})},clearFieldValue:function(e){e.find("[data-field-control]").each(function(){var e=g(this),i=e.closest(".gsf-field");i.data("field-value","");if(GSF.helper.isSelect(e)){e.prop("selectedIndex",0)}else if(GSF.helper.isCheckBox(e)||GSF.helper.isRadio(e)){e.prop("checked",false)}else{e.val("")}})},getValue:function(e){var i="";if(e.find(".gsf-field-clone-item").length>0){i=[];e.find(".gsf-field-clone-item").each(function(){var e=g(this).find("> .gsf-field-content-inner");i.push(e[0].fieldJs!=null?e[0].fieldJs.getValue():"")})}else{var n=e.find(".gsf-field-content-inner");if(n.length){if(n[0].fieldJs!=null){i=n[0].fieldJs.getValue()}}}return i}};GSF.group={init:function(){this.toggleGroup()},toggleGroup:function(){e.on("click",".gsf-field-group-title",function(e){var i=g(e.target),n=i.closest(".gsf-field-group");n.toggleClass("in");n.find("> .gsf-field-group-content").slideToggle(function(){g(this).closest(".gsf-meta-box-wrap").find(".gsf-sections > ul").hcSticky("refresh")})})}};GSF.panel={init:function(){this.togglePanel()},togglePanel:function(){e.on("click",".gsf-field-panel-title",function(e){var i=g(e.target),n=i.closest(".gsf-field-panel-clone-item");if(i.closest(".gsf-clone-button-remove").length){return}i.closest(".gsf-field-panel-clone").find(".gsf-field-panel-clone-item").each(function(){if(n.length==0||this!=n[0]){g(this).find(".gsf-field-panel-content").slideUp();g(this).addClass("in")}});if(n.length){n.toggleClass("in");n.find(".gsf-field-panel-content").slideToggle()}else{var t=i.closest(".gsf-field-panel");t.toggleClass("in");t.find(".gsf-field-panel-content").slideToggle()}})},sortable:function(){}};GSF.required={processApplyField:function(e){var d=[];g(e).find(".gsf-field[data-required]").each(function(){var e=g(this),i=e.data("required"),n=e.attr("id"),t,l,f,r,s,a,o;if(g.isArray(i[0])){for(t=0;t<i.length;t++){f=i[t];if(g.isArray(f[0])){for(l=0;l<f.length;l++){r=f[l];s=r[0];a=r[1];o=r[2];if(s.indexOf("[")!=-1){s=s.replace(/\[.*/i,"")}if(typeof d[s]==="undefined"){d[s]=[]}if(d[s].indexOf(n)===-1){d[s].push(n)}if(a[0]==="&"){if(typeof d[o]==="undefined"){d[o]=[]}if(d[o].indexOf(n)===-1){d[o].push(n)}}}}else{s=f[0];a=f[1];o=f[2];if(s.indexOf("[")!=-1){s=s.replace(/\[.*/i,"")}if(typeof d[s]==="undefined"){d[s]=[]}if(d[s].indexOf(n)===-1){d[s].push(n)}if(a[0]==="&"){if(typeof d[o]==="undefined"){d[o]=[]}if(d[o].indexOf(n)===-1){d[o].push(n)}}}}}else{s=i[0];a=i[1];o=i[2];if(s.indexOf("[")!=-1){s=s.replace(/\[.*/i,"")}if(typeof d[s]==="undefined"){d[s]=[]}if(d[s].indexOf(n)===-1){d[s].push(n)}if(a[0]==="&"){if(typeof d[o]==="undefined"){d[o]=[]}if(d[o].indexOf(n)===-1){d[o].push(n)}}}});e.applyFieldRequired=d},onChange:function(e){e.find(".gsf-field").on("gsf_check_required",GSF.required.onChangeEvent)},onChangeEvent:function(e){if(this!=e.target){return}var i=g(this),n=i.closest(".gsf-meta-box-wrap"),t=n[0].applyFieldRequired,l=i.attr("id"),f=i.closest(".gsf-field-panel-inner");if(t==null){return}if(typeof i.data("field-value")=="undefined"){return}if(typeof t[l]==="undefined"){return}for(var r=0;r<t[l].length;r++){if(f.length){GSF.required.toggleField(f.find('[id="'+t[l][r]+'"]'),f,n)}else{GSF.required.toggleField(n.find('[id="'+t[l][r]+'"]'),f,n)}}},toggleField:function(e,i,n){var t=e.data("required"),l=true;if(!g.isArray(t[0])){l=GSF.required.processField(t,i,n)}else{l=GSF.required.andCondition(t,i,n)}if(l){e.slideDown()}else{e.slideUp()}},andCondition:function(e,i,n){var t,l;for(l=0;l<e.length;l++){t=e[l];if(!g.isArray(t[0])){if(!GSF.required.processField(t,i,n)){return false}}else{if(!GSF.required.orCondition(t,i,n)){return false}}}return true},orCondition:function(e,i,n){var t,l;for(l=0;l<e.length;l++){t=e[l];if(GSF.required.processField(t,i,n)){return true}}return false},processField:function(e,i,n){var t=e[0],l=e[1],f=e[2],r,s="";if(t.indexOf("[")!=-1){var a=t.replace(/\[.*/i,"");s=t.substring(a.length);s=s.substr(1,s.length-2);t=a}if(i.length){r=i.find('[id="'+t+'"]').data("field-value")}else{r=n.find('[id="'+t+'"]').data("field-value")}if(s!==""&&typeof r[s]!=="undefined"){r=r[s]}if(l.substr(0,1)==="&"){if(i.length){f=i.find("#"+f).data("field-value")}else{f=g("#"+f).data("field-value")}}switch(l){case"=":case"&=":return f==r;case"!=":case"&!=":return f!=r;case"in":case"&in":return f==r||g.isArray(f)&&f.indexOf(r)!=-1;case"not in":case"&not in":return!g.isArray(f)&&f!=r||f.indexOf(r)==-1;case"contain":case"&contain":return f==r||g.isArray(r)&&r.indexOf(f)!=-1||typeof r==="object"&&(r!=null&&f in r);case"not contain":case"&not contain":return r==null||g.isArray(r)&&r.indexOf(f)==-1||typeof r==="object"&&!(f in r)||!g.isArray(r)&&typeof r!=="object"&&r!=f}return false}};GSF.preset={init:function(){this.onCheckPreset()},onCheckPreset:function(){g(document).on("gsf_check_preset",".gsf-field",function(e){if(this!=e.target){return}var i=g(this),n=i.closest(".gsf-field-panel-inner");if(n.length===0){n=g(".gsf-meta-box-wrap")}if(typeof i.data("field-value")=="undefined"){return}var t=i.data("preset");if(typeof t=="undefined"){return}var l=i.data("field-value"),f,r,s,a,o;for(f=0;f<t.length;f++){s=t[f]["op"];a=t[f]["value"];o=t[f]["fields"];if(s==="="&&a==l||s==="!="&&a!=l){for(r=0;r<o.length;r++){var d=n.find("#"+o[r][0]),c=d.find("[data-field-control]");if(d.length>0&&d[0]!=this){if(typeof o[r][1]=="object"){for(var u in o[r][1]){d.find('[name$="['+u+']"]').val(o[r][1][u])}}else{if(GSF.helper.isRadio(c)||GSF.helper.isCheckBox(c)){d.find('[data-field-control][value="'+o[r][1]+'"]').prop("checked",true)}else{c.val(o[r][1])}}}c.trigger("gsf_preset_change",o[r][1]);c.trigger("change")}break}}})}};GSF.onReady={init:function(){GSF.fields.init();GSF.group.init();GSF.panel.init();GSF.preset.init();g(".gsf-field").trigger("gsf_check_required")}};GSF.onResize={init:function(){}};e.ready(GSF.onReady.init);g(window).resize(GSF.onResize.init)})(jQuery);