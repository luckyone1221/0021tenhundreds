!function(a){"use strict";var b=b||{};b.onReady={init:function(){b.postFormats.init(),b.media.init()}},b.postFormats={init:function(){b.postFormats.switchTab(),b.postFormats.renderUI()},switchTab:function(){a("body").on("click","#g5plus-post-formats-ui-tabs a",function(b){b.preventDefault();var c=a(this),d=c.attr("href").replace("#",""),e=a("#g5plus-pfui-"+d);c.hasClass("current")||(a('#g5plus-post-formats-ui-tabs a[class="current"]').removeClass("current"),c.addClass("current"),a('[id^="g5plus-pfui-post-format-"]').hide(),e.show(),a("#"+d).trigger("click"))})},renderUI:function(){a("#g5plus-post-formats-ui-tabs").insertBefore(a("form#post")).show(),a("#g5plus-pfui-post-format-link, #g5plus-pfui-post-format-video, #g5plus-pfui-post-format-audio").insertAfter(a("#titlediv")),a("#g5plus-pfui-post-format-gallery").find("dt a").each(function(){a(this).replaceWith(a(this.childNodes))}).end().insertAfter(a("#titlediv")),a("#g5plus-pfui-post-format-quote").insertAfter(a("#titlediv")),a(document).trigger("g5plus-post-formats-ui-init");var b=a('#g5plus-post-formats-ui-tabs a[class="current"]').attr("href").replace("#","");a("#g5plus-pfui-"+b).show()}},b.media={_frame:null,init:function(){a("#wpbody").on("click",".g5plus-pfui-gallery-button",function(a){a.preventDefault(),b.media.frame().open()}),this.event()},event:function(){var b=a(".g5plus-pfui-gallery-picker .gallery");b.on("update",function(){var b=[];a(this).find("> span").each(function(){b.push(a(this).data("id"))}),a('[name="g5plus_format_gallery_images"]').val(b.join(","))}),b.sortable({placeholder:"g5plus-pfui-ui-state-highlight",revert:200,tolerance:"pointer",stop:function(){b.trigger("update")}}),b.on("click","span.close",function(c){a(this).parent().fadeOut(200,function(){a(this).remove(),b.trigger("update")})})},frame:function(){return this._frame?this._frame:(this._frame=wp.media({title:g5plus_pfui_post_format.media_title,library:{type:"image"},button:{text:g5plus_pfui_post_format.media_button},multiple:!0}),this._frame.on("open",this.updateFrame).state("library").on("select",this.select),this._frame)},select:function(){var b=this.get("selection"),c=a(".g5plus-pfui-gallery-picker .gallery");b.each(function(a){var b=a.attributes.url;void 0!==a.attributes.sizes&&void 0!==a.attributes.sizes.thumbnail&&(b=a.attributes.sizes.thumbnail.url),c.append('<span data-id="'+a.id+'" title="'+a.attributes.title+'"><img src="'+b+'" alt="" /><span class="close">x</span></span>'),c.trigger("update")})},updateFrame:function(){}},a(document).ready(b.onReady.init)}(jQuery);